{"id":719049087,"lang":"mysql","time":"4 days, 18 hours","timestamp":1654883224,"status_display":"Accepted","runtime":"463 ms","url":"/submissions/detail/719049087/","is_pending":"Not Pending","title":"Capital Gain/Loss","memory":"0B","code":"# Write your MySQL query statement below\nwith cte1 as(\nselect stock_name,sum(price) as buyprice from stocks where operation='Buy' group by stock_name\n),cte2 as(\nselect stock_name,sum(price) as sellprice from stocks where operation='Sell' group by stock_name\n)\n\nselect b.stock_name,s.sellprice-b.buyprice as capital_gain_loss from cte1 b join cte2 s on b.stock_name=s.stock_name ","compare_result":"11111111111111111","title_slug":"capital-gainloss"}